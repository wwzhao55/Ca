<!DOCTYPE html>
<html>
<head>
    <meta http-equiv=”Content-Type” content=”text/html; charset=utf-8″>
    <meta name="viewport" content="width=750,inital-scale=1.0,maximum-scale=2.0,user-scalable=yes;">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <link href="content.css" rel="stylesheet">
    <script src="//cdn.bootcss.com/jquery/3.1.0/jquery.min.js"></script>
    <title>ZERTO 调查问卷</title>
    <head>
<body>
<div class='container'>
    <div class='title'>
        <img src='image/Logo@2x.png' alt='logo' width='240' height=68>
    </div>
    <form method='post' onsubmit="return false" id='reg_form' name='reg_form'>
        <input type='text' name='name' placeholder="姓名">
        <input type='text' name='email' placeholder="职位">
        <input type='email' name='email' placeholder="邮箱">
        <input type='text' name='company' placeholder="公司">
        <input type='text' name='company' placeholder="电话">

        <div class='dropdown'>
            <button><span>1.贵企业现在有多少开发人员？</span><span class='caret'></span></button>
            <input type='text' name='company_type'>
            <ul class='form-select select_type select_company_type'>
                <li value="企业">数十人</li>
                <li value="云提供商">数百人</li>
                <li value="转销商/集成商">数千人</li>
                <li value="其他">外包</li>
            </ul>
        </div>
        <div class='dropdown' >
            <button id="ymh"><span>2.在过去6个月中，贵公司是否发生过应用系统宕机或者性能太慢而接到大量用户投诉？</span><span class='caret'></span></button>
            <input type='text' name='company_type'>
            <ul class='form-select select_type select_company_type'>
                <li value="企业">有</li>
                <li value="云提供商">没有</li>
            </ul>
        </div>
        <div class='dropdown'>
            <button><span>4.这个项目是否已经获得预算支持？ </span><span class='caret'></span></button>
            <input type='text' name='company_type'>
            <ul class='form-select select_type select_company_type'>
                <li value="企业">A.是的，0~6个月内</li>
                <li value="云提供商">B.是的， 6~12个月内</li>
                <li value="转销商/集成商">C.尚未得到业务部门的支持</li>
            </ul>
        </div>
        <div class='dropdown'>
            <button><span>6.我们可以通过何种方式帮您解决这些问题？</span><span class='caret'></span></button>
            <input type='text' name='company_type'>
            <ul class='form-select select_type select_company_type'>
                <li value="企业">A.发给我CA Technologies解决方案的相关信息</li>
                <li value="云提供商">B.联系我并安排一次技术交流</li>
            </ul>
        </div>
        <div class='dropdown'>
            <button><span>7.您在进程决策中所扮演的角色可被描述为:</span><span class='caret'></span></button>
            <input type='text' name='company_type'>
            <ul class='form-select select_type select_company_type'>
                <li value="企业">A.影响者</li>
                <li value="云提供商">B.最终决策者</li>
                <li value="转销商/集成商">C.其他</li>
            </ul>
        </div>
        <div class='err_msg'></div>
        <button type='button' id='reg_submit'>确定</button>
    </form>
</div>
<script type='text/javascript'>
    function trim(str) {
        return str.replace(/(^\s*)|(\s*$)/g, "");
    }
    function checkEmail()//验证邮箱
    {
        var email = reg_form.email.value;
        var objExp = new RegExp(/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/);
        if (objExp.test(email) == false)
            return "邮箱格式有误";
        else {
            return true;
        }
    }
    function checkTel()//验证手机号
    {
        var tel = reg_form.phone.value;

        var objExp = new RegExp(/^[1\s][\d\s]{10}$/);
        if (objExp.test(tel) == false) {
            return "手机号码无效";
        }
        else
            return true;
    }
    $('#reg_submit').on('click', function () {
        var name = reg_form.name.value;
        var email = reg_form.email.value;
        var company = reg_form.company.value;
        var company_type = reg_form.company_type.value;
        var phone = reg_form.phone.value;
        var job_title = reg_form.job_title.value;
        var province = reg_form.province.value;
        var infrastructure = reg_form.infrastructure.value;
        if (trim(name) && trim(email) && trim(company) && trim(company_type) && trim(phone) && trim(job_title) && trim(province) && trim(infrastructure)) {
            var check1 = checkEmail($("input[name='email']").val());
            var check2 = checkTel($("input[name='phone']").val());
            if (check1 == true && check2 == true) {
                $.ajax({
                    type: 'post',
                    url: 'register.php',
                    data: $("#reg_form").serialize(),
                    dataType: 'json',
                    success: function (result) {
                        if (result.status == 'success') {
                            window.location.href = 'welcome.html';
                        } else {
                            $('.err_msg').html('*' + result.msg);
                        }
                    }
                })
            } else {
                if (check1 == true) {
                    $('.err_msg').html('*' + check2);
                } else {
                    $('.err_msg').html('*' + check1);
                }
            }
        } else {
            $('.err_msg').html('请填写完整信息！');
        }
    })

    $('.dropdown button').on('click', function () {
        $(this).closest('.dropdown').siblings('.dropdown').children('ul').hide();
        $(this).siblings('ul').toggle();
        if ($(this).closest('.dropdown').is(':visible')) {
            $(this).closest('.dropdown').addClass('active');
        }
    })
    $('.dropdown ul li').on('click', function () {
        $(this).closest('ul').siblings('button').css('color', '#333');
        $(this).siblings('li').removeClass('active');
        $(this).addClass('active');
        var text = $(this).html();
        var value = $(this).attr('value');
        $(this).closest('ul').siblings('button').children('span').eq(0).html(text);
        $(this).closest('ul').siblings('input').val(value);
        $(this).closest('ul').toggle();
    })
    $(document).bind("click", function (e) {
        var target = $(e.target);
        if (target.closest(".dropdown").length == 0) {
            $(".dropdown ul").hide();
        }
    })
</script>
</body>
</html>
