<!DOCTYPE html>
<html>
<head>
    <meta http-equiv=”Content-Type” content=”text/html; charset=utf-8″>
    <meta name="viewport" content="width=750,inital-scale=1.0,maximum-scale=2.0,user-scalable=yes;">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <link href="questionnaire.css" rel="stylesheet">
    <script src="//cdn.bootcss.com/jquery/3.1.0/jquery.min.js"></script>
    <title>ZERTO 调查问卷</title>
    <head>
<body>
<div class='container'>
    <div class='title'>
        <img src='image/wenjuandiaocha@2x.png' alt='logo' width='100%' height=180>
    </div>
    <form method='post' onsubmit="return false" id='reg_form' name='reg_form'>
        <input id="in1" type='text' name='name' placeholder="姓名">
        <input id="in2" type='text' name='company' placeholder="公司">
        <input id="in3" type='text' name='site' placeholder="职位">
        <input id="in4" type='text' name='phone' placeholder="电话">
        <input id="in5" type='email' name='email' placeholder="邮箱">
        <div class="title">1.贵企业现在有多少开发人员？</div>
        <div class='dropdown'>
            <button><span></span><span class='caret'></span></button>
            <input type='text' name='one'>
            <ul class='form-select select_type select_company_type'>
                <li value="A">A.数十人</li>
                <li value="B">B.数百人</li>
                <li value="C">C.数千人</li>
                <li value="D">D.外包</li>
            </ul>
        </div>
        <div class="title">2.在过去6个月中，贵公司是否发生过应用系统宕机或者性能太慢而接到大量用户投诉？</div>
        <div class='dropdown'>
            <button><span></span><span class='caret'></span></button>
            <input type='text' name='two'>
            <ul class='form-select select_type select_company_type'>
                <li value="A">A.有</li>
                <li value="B">B.没有</li>
            </ul>
        </div>
        <div class="title">3.在以下领域中，哪些是您接下来的6个月中最需要改善的？（可多选）</div>
        <div>
            <div style="display: block"><input id="y1" class="check" type="checkbox" value=""
                                               style="display: inline-block ;width: 20px;height: 20px"/><span
                    class="ttt">服务虚拟化管理</span>
            </div>
            <div style="display: block"><input id="y2" class="check" type="checkbox" value=""
                                               style="display: inline-block ;width: 20px;height: 20px"/><span
                    class="ttt">API安全管理</span>
            </div>
            <div style="display: block"><input id="y3" class="check" type="checkbox" value=""
                                               style="display: inline-block ;width: 20px;height: 20px"/><span
                    class="ttt">应用性能管理</span>
            </div>
            <div style="display: block"><input id="y4" class="check" type="checkbox" value=""
                                               style="display: inline-block ;width: 20px;height: 20px"/><span
                    class="ttt">发布自动化管理</span>
            </div>
            <div style="display: block"><input id="y5" class="check" type="checkbox" value=""
                                               style="display: inline-block ;width: 20px;height: 20px"/><span
                    class="ttt">基础设施统一监控</span>
            </div>
            <div style="display: block"><input id="y6" class="check" type="checkbox" value=""
                                               style="display: inline-block ;width: 20px;height: 20px"/><span
                    class="ttt">移动应用分析</span>
            </div>
            <div style="display: block"><input id="y7" class="check" type="checkbox" value=""
                                               style="display: inline-block ;width: 20px;height: 20px"/><span
                    class="ttt">其他</span>
            </div>
        </div>
        <div class="title">4.这个项目是否已经获得预算支持？</div>
        <div class='dropdown'>
            <button><span></span><span class='caret'></span></button>
            <input type='text' name='four'>
            <ul class='form-select select_type select_company_type'>
                <li value="A">A.是的，0~6个月内</li>
                <li value="B">B.是的， 6~12个月内</li>
                <li value="C">C.尚未得到业务部门的支持</li>
            </ul>
        </div>
        <div class="title">5.您目前正在着眼解决什么具体的IT问题？</div>
        <input type="text" id="five">
        <div class="title">6.我们可以通过何种方式帮您解决这些问题？</div>
        <div class='dropdown'>
            <button><span></span><span class='caret'></span></button>
            <input type='text' name='six'>
            <ul class='form-select select_type select_company_type'>
                <li value="A">A.发给我CA Technologies解决方案的相关信息</li>
                <li value="B">B.联系我并安排一次技术交流</li>
            </ul>
        </div>
        <div class="title">7.您在进程决策中所扮演的角色可被描述为:</div>
        <div class='dropdown'>
            <button><span></span><span class='caret'></span></button>
            <input type='text' name='seven'>
            <ul class='form-select select_type select_company_type'>
                <li value="A">A.影响者</li>
                <li value="B">B.最终决策者</li>
                <li value="C">C.其他</li>
            </ul>
        </div>
        <div class='err_msg'></div>
        <button type='button' id='reg_submit'>确定</button>
    </form>
</div>
<script type='text/javascript'>
    function trim(str) {
        return str.replace(/(^\s*)|(\s*$)/g, "");
    }
    function checkEmail()//验证邮箱
    {
        var email = reg_form.email.value;
        var objExp = new RegExp(/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/);
        if (objExp.test(email) == false)
            return "邮箱格式有误";
        else {
            return true;
        }
    }
    function checkTel()//验证手机号
    {
        var tel = reg_form.phone.value;

        var objExp = new RegExp(/^[1\s][\d\s]{10}$/);
        if (objExp.test(tel) == false) {
            return "手机号码无效";
        }
        else
            return true;
    }
    $('#reg_submit').on('click', function () {
        var name = reg_form.name.value;
        var job = reg_form.site.value;
        var email = reg_form.email.value;
        var company = reg_form.company.value;
        var phone = reg_form.phone.value;
        var one = reg_form.one.value;
        var two = reg_form.two.value;
        var four = reg_form.four.value;
        var five = document.getElementById("five").value;
        var six = reg_form.six.value;
        var seven = reg_form.seven.value;
        if (trim(name) && trim(job) && trim(email) && trim(company) && trim(phone) && trim(one) && trim(two)
                && trim(four) && trim(five) && trim(six) && trim(seven)) {
            var c1 = 0;
            var c2 = 0;
            var c3 = 0
            var c4 = 0;
            var c5 = 0;
            var c6 = 0;
            var c7 = 0;
            if (document.getElementById("y1").checked) {
                c1 = 1;
            }
            if (document.getElementById("y2").checked) {
                c2 = 1;
            }
            if (document.getElementById("y3").checked) {
                c3 = 1;
            }
            if (document.getElementById("y4").checked) {
                c4 = 1;
            }
            if (document.getElementById("y5").checked) {
                c5 = 1;
            }
            if (document.getElementById("y6").checked) {
                c6 = 1;
            }
            if (document.getElementById("y7").checked) {
                c7 = 1;
            }
            var c = c1 + c2 + c3 + c4 + c5 + c6 + c7;
            var check1 = checkEmail($("input[name='email']").val());
            var check2 = checkTel($("input[name='phone']").val());
            if (check1 == true && check2 == true && c != "0000000") {
                var data = "name=" + name + "&job=" + job + "&company=" + company +
                        "&phone=" + phone + "&" +
                        "email=" + email + "&" +
                        "question1=" + one + "&" +
                        "question2=" + two + "&" +
                        "question3_1=" + c1 + "&" +
                        "question3_2=" + c2 + "&" +
                        "question3_3=" + c3 + "&" +
                        "question3_4=" + c4 + "&" +
                        "question3_5=" + c5 + "&" +
                        "question3_6=" + c6 + "&" +
                        "question3_7=" + c7 + "&" +
                        "question4=" + four + "&" +
                        "question5=" + five + "&" +
                        "question6=" + six + "&" +
                        "question7=" + seven;
                $.ajax({
                    type: 'post',
                    url: 'http://ca.dataguiding.com/survey.php',
                    data: data,
                    dataType: 'json',
                    success: function (result) {
                        if (result.status == 'success') {
                            window.location.href = 'welcome.html';
                        } else {
                            alert("传输错误")
                            $('.err_msg').html('*' + result.msg);
                        }
                    }
                })
            } else {
//                if (check1 == true) {
//                    $('.err_msg').html('*' + check2);
//                } else {
//                    $('.err_msg').html('*' + check1);
//                }
                alert("请输入完整信息！")
            }
        } else {
            alert("请输入完整信息！")
//            $('.err_msg').html('请填写完整信息！');
        }
    })

    $('.dropdown button').on('click', function () {
        $(this).closest('.dropdown').siblings('.dropdown').children('ul').hide();
        $(this).siblings('ul').toggle();
        if ($(this).closest('.dropdown').is(':visible')) {
            $(this).closest('.dropdown').addClass('active');
        }
    })
    $('.dropdown ul li').on('click', function () {
        $(this).closest('ul').siblings('button').css('color', '#333');
        $(this).siblings('li').removeClass('active');
        $(this).addClass('active');
        var text = $(this).html();
        var value = $(this).attr('value');
        $(this).closest('ul').siblings('button').children('span').eq(0).html(text);
        $(this).closest('ul').siblings('input').val(value);
        $(this).closest('ul').toggle();
    })
    $(document).bind("click", function (e) {
        var target = $(e.target);
        if (target.closest(".dropdown").length == 0) {
            $(".dropdown ul").hide();
        }
    })
</script>
</body>
</html>
